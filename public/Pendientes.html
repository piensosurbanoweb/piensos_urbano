<div id="pestanaPedidosPendientes" class="p-6">
    <div class="flex justify-between items-center mb-6">
        <h2 class="text-2xl font-bold text-gray-800">ðŸ“‹ Pedidos Pendientes de Programar</h2>
        <div class="flex items-center gap-4">
            <div class="text-sm text-gray-600">
                Total pendientes: <span id="totalPendientes" class="font-semibold text-red-600">0</span>
            </div>
            <div class="flex gap-2">
                <select id="ordenarPendientes" onchange="ordenarPedidosPendientes()" class="px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500">
                    <option value="zona">Ordenar por Zona</option>
                    <option value="fechaPedido">Ordenar por Fecha Pedido</option>
                    <option value="fechaEntrega">Ordenar por Fecha Entrega</option>
                    <option value="apodo">Ordenar por Apodo</option>
                </select>
            </div>
        </div>
    </div>

    <div id="listaPedidosPendientes" class="space-y-4">
        </div>

    <div id="mensajeVacioPendientes" class="text-center py-12 text-gray-500 hidden">
        <div class="text-4xl mb-4">âœ…</div>
        <p class="text-lg">No hay pedidos pendientes</p>
        <p class="text-sm">Todos los pedidos han sido programados</p>
    </div>
</div>

<script>
    async function cargarPedidosPendientes() {
        try {
            const res = await fetch('/pedidos/pendientes');
            const pedidos = await res.json();
            renderizarPedidosPendientes(pedidos);
        } catch (err) {
            console.error('Error al obtener pedidos pendientes:', err);
        }
    }

    function renderizarPedidosPendientes(pedidos) {
        const lista = document.getElementById('listaPedidosPendientes');
        const mensajeVacio = document.getElementById('mensajeVacioPendientes');
        const totalPendientes = document.getElementById('totalPendientes');
        lista.innerHTML = '';
        totalPendientes.textContent = pedidos.length;
        if (pedidos.length === 0) {
            mensajeVacio.classList.remove('hidden');
        } else {
            mensajeVacio.classList.add('hidden');
            pedidos.forEach(pedido => {
                const div = document.createElement('div');
                div.className = 'bg-white p-4 rounded-lg shadow-md';
                div.innerHTML = `
                    <div class="flex justify-between items-start mb-2">
                        <div>
                            <h3 class="font-bold text-lg">${pedido.apodo_cliente} - ${pedido.producto}</h3>
                            <p class="text-sm text-gray-600">Cantidad: ${pedido.cantidad} | Fecha de Entrega: ${new Date(pedido.fecha_entrega).toLocaleDateString()}</p>
                        </div>
                        <div class="flex gap-2">
                            <button onclick="marcarPedidoComoProgramado(${pedido.id})" class="text-green-600 hover:text-green-900">âœ… Programado</button>
                        </div>
                    </div>
                    <p class="text-sm text-gray-500">${pedido.observaciones || ''}</p>
                `;
                lista.appendChild(div);
            });
        }
    }

    async function ordenarPedidosPendientes() {
        // LÃ³gica de ordenaciÃ³n si la necesitas
        await cargarPedidosPendientes();
    }

    async function marcarPedidoComoProgramado(id) {
        if (confirm('Â¿Marcar este pedido como programado? Se eliminarÃ¡ de la lista de pendientes.')) {
            try {
                const res = await fetch(`/pedidos/programar/${id}`, { method: 'PUT' });
                if (res.ok) {
                    cargarPedidosPendientes();
                } else {
                    console.error('Error al marcar pedido como programado');
                }
            } catch (err) {
                console.error('Error de red:', err);
            }
        }
    }

    document.addEventListener('DOMContentLoaded', () => {
        cargarPedidosPendientes();
    });
</script>